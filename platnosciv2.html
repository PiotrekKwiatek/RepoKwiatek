<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<title>Płatność składki – Santander</title>
<style>
  #qrcode canvas {
    margin-top: 10px;
    border: 1px solid #000;
  }
</style>
</head>
<body>

<h1>Opłać składkę</h1>

<label>Cel wpłaty:
<select id="cel">
  <option value="Skladka%20Maj%202025|50.00">Składka maj 2025 – 50 zł</option>
  <option value="Biwak%20wiosenny|120.00">Biwak wiosenny – 120 zł</option>
  <option value="Oboz%20letni|950.00">Obóz letni – 950 zł</option>
</select>
</label>
<br><br>

<label>Imię i nazwisko:
<input type="text" id="nazwisko" placeholder="Jan Kowalski" />
</label>
<br><br>

<button onclick="generuj()">Generuj link i QR kod</button>

<p>Link do płatności:</p>
<a href="#" id="link" target="_blank" rel="noopener noreferrer"></a>

<div id="qrcode"></div>

<!-- biblioteka QRCode.js -->
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<script>
function generuj() {
  const celSelect = document.getElementById("cel");
  const [tytul, kwota] = celSelect.value.split("|");
  let nazwisko = document.getElementById("nazwisko").value.trim();

  if (!nazwisko) {
    alert("Proszę wpisać imię i nazwisko.");
    return;
  }

  // Zamień spacje na %20 w tytule
  nazwisko = nazwisko.replace(/ /g, "%20");
  const finalTytul = `${tytul} - ${nazwisko}`;

  // Twój numer konta w formacie IBAN (bez spacji)
  const nrKonta = "PL63109019260000000514000254";

  // Budujemy link do Santander (bankowość internetowa)
  const link = `https://www.centrum24.pl/app/centrum24/bank/form/transfer?recipientName=Twoja%20Organizacja&recipientAccount=${nrKonta}&amount=${kwota}&title=${finalTytul}`;

  // Ustawiamy link w elemencie <a>
  const linkEl = document.getElementById("link");
  linkEl.href = link;
  linkEl.textContent = "Kliknij tutaj, aby zapłacić";

  // Generujemy QR kod w canvas
  const qrcodeEl = document.getElementById("qrcode");
  qrcodeEl.innerHTML = ""; // czyścimy poprzedni QR

  const canvas = document.createElement("canvas");
  qrcodeEl.appendChild(canvas);

  QRCode.toCanvas(canvas, link, { width: 200 }, function (error) {
    if (error) {
      alert("Błąd generowania QR kodu: " + error);
      console.error(error);
    }
  });
}
</script>

</body>
</html>
