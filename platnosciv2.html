<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8" />
<title>Płatność składki z QR kodem</title>
<style>
  body { font-family: Arial, sans-serif; max-width: 400px; margin: 20px auto; }
  label { display: block; margin-top: 15px; }
  select, input { width: 100%; padding: 8px; margin-top: 5px; box-sizing: border-box; }
  button { margin-top: 20px; padding: 10px; width: 100%; font-size: 16px; }
  #wynik { margin-top: 20px; padding: 15px; border: 1px solid #ccc; background: #f9f9f9; white-space: pre-wrap; }
  #qrcode { margin-top: 20px; text-align: center; }
</style>
</head>
<body>

<h1>Opłać składkę</h1>

<label>Cel wpłaty:
  <select id="cel">
    <option value="Skladka maj 2025|50.00">Składka maj 2025 – 50 zł</option>
    <option value="Biwak wiosenny|120.00">Biwak wiosenny – 120 zł</option>
    <option value="Obóz letni|950.00">Obóz letni – 950 zł</option>
  </select>
</label>

<label>Imię i nazwisko:
  <input type="text" id="nazwisko" placeholder="Jan Kowalski" />
</label>

<button onclick="generuj()">Generuj dane i QR kod</button>

<div id="wynik"></div>
<div id="qrcode"></div>

<!-- Biblioteka do QR kodów -->
<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>

<script>
const nrKonta = "PL63109019260000000514000254"; // Podmień na swój numer konta IBAN bez spacji

function generuj() {
  const wynikEl = document.getElementById("wynik");
  const qrcodeEl = document.getElementById("qrcode");
  wynikEl.textContent = "";
  qrcodeEl.innerHTML = "";

  const cel = document.getElementById("cel").value;
  const [tytul, kwota] = cel.split("|");
  const nazwiskoRaw = document.getElementById("nazwisko").value.trim();

  if (!nazwiskoRaw) {
    alert("Proszę wpisać imię i nazwisko.");
    return;
  }

  const tytulPelny = `${tytul} - ${nazwiskoRaw}`;

  // Pokaż dane do przelewu
  wynikEl.textContent =
    `Numer konta: ${nrKonta}\n` +
    `Kwota: ${kwota} zł\n` +
    `Tytuł przelewu: ${tytulPelny}`;

  // Generowanie tekstu QR wg Polskiego Standardu QR (PSR)
  // Format: https://standardqr.pl/
  // Przykład uproszczony:

  const kwotaFormat = parseFloat(kwota).toFixed(2).replace('.', ',');
  const nazwaOdbiorcy = "Twoja Organizacja"; // podmień na swoją nazwę

  const qrText = 
`BCD
001
1
SCT
Santander Bank Polska
${nrKonta.replace(/PL/, '')}
${nazwaOdbiorcy}
PL
${kwotaFormat}
${tytulPelny}
`;

  // Tworzymy QR kod z powyższym tekstem
  QRCode.toCanvas(qrcodeEl, qrText, { width: 200 }, function (error) {
    if (error) console.error(error);
  });
}
</script>

</body>
</html>
